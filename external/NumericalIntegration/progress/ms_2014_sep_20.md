# comparison of STB's and MS's code for Laurie-Gautschi and Piessens method
        
The machine epsilon value in the Piessens code remains as a double due to my lack of understanding in it's templating, although here are initial results in comparing Piessen's method to the Laurie approach.

As Sree accomplished previously and in the same manner, the `RealType` in the code is varied as:

    1. double
    2. mpreal(128)
    3. mpreal(256)

by changing the line 7-10 in `tests/testLaurieGautschi.cpp`:

    typedef double RealType;
    //typedef mpfr::mpreal RealType;
    //RealType::set_default_prec(128);
    //RealType::set_default_prec(256);


## `RealType` => `double`

As with Sree's previous test, here are MS and STB Laurie code and MS Piessens as double precision illustrating minor differences in each approach at the last digit due to floating point error:

    MS Laurie Gautschi
    -0.995657163025808  	0.011694638867371
    -0.973906528517172  	0.032558162307965
    -0.930157491355708  	0.054755896574351
    -0.865063366688984  	0.075039674810920
    -0.780817726586417  	0.093125454583698
    -0.679409568299025  	0.109387158802297
    -0.562757134668604  	0.123491976262066
    -0.433395394129247  	0.134709217311474
    -0.294392862701460  	0.142775938577059
    -0.148874338981631  	0.147739104901337
     0.000000000000003  	0.149445554002917
     0.148874338981632  	0.147739104901341
     0.294392862701461  	0.142775938577061
     0.433395394129247  	0.134709217311473
     0.562757134668605  	0.123491976262066
     0.679409568299024  	0.109387158802298
     0.780817726586416  	0.093125454583696
     0.865063366688984  	0.075039674810919
     0.930157491355706  	0.054755896574355
     0.973906528517170  	0.032558162307960
     0.995657163025810  	0.011694638867375

    STB Laurie Gautschi
    -0.995657163025808  	0.011694638867371
    -0.973906528517172  	0.032558162307965
    -0.930157491355708  	0.054755896574352
    -0.865063366688984  	0.075039674810920
    -0.780817726586417  	0.093125454583698
    -0.679409568299024  	0.109387158802295
    -0.562757134668605  	0.123491976262070
    -0.433395394129247  	0.134709217311471
    -0.294392862701460  	0.142775938577060
    -0.148874338981632  	0.147739104901337
    -0.000000000000001  	0.149445554002917
     0.148874338981631  	0.147739104901338
     0.294392862701461  	0.142775938577061
     0.433395394129249  	0.134709217311475
     0.562757134668606  	0.123491976262067
     0.679409568299024  	0.109387158802296
     0.780817726586417  	0.093125454583699
     0.865063366688987  	0.075039674810919
     0.930157491355710  	0.054755896574353
     0.973906528517173  	0.032558162307966
     0.995657163025808  	0.011694638867369

    MS Piessens
    -0.995657163025808  	0.011694638867372
    -0.973906528517172  	0.032558162307964
    -0.930157491355708  	0.054755896574352
    -0.865063366688985  	0.075039674810920
    -0.780817726586417  	0.093125454583698
    -0.679409568299024  	0.109387158802298
    -0.562757134668605  	0.123491976262066
    -0.433395394129247  	0.134709217311473
    -0.294392862701460  	0.142775938577060
    -0.148874338981631  	0.147739104901338
    -0.000000000000000  	0.149445554002917
     0.148874338981631  	0.147739104901338
     0.294392862701460  	0.142775938577060
     0.433395394129247  	0.134709217311473
     0.562757134668605  	0.123491976262066
     0.679409568299024  	0.109387158802298
     0.780817726586417  	0.093125454583698
     0.865063366688985  	0.075039674810920
     0.930157491355708  	0.054755896574352
     0.973906528517172  	0.032558162307964
     0.995657163025808  	0.011694638867372


## `RealType` => `mpreal(256)`
Here are MS and STB Laurie code and the MS Piessens as mpreal(256) illustrating complete agreement in all approaches:

    MS Laurie Gautschi
    -0.995657163025808  	0.0116946388673719
    -0.973906528517172  	0.0325581623079647
    -0.930157491355708  	0.054755896574352
    -0.865063366688985  	0.07503967481092
    -0.780817726586417  	0.0931254545836976
    -0.679409568299024  	0.109387158802298
    -0.562757134668605  	0.123491976262066
    -0.433395394129247  	0.134709217311473
    -0.29439286270146   	0.14277593857706
    -0.148874338981631  	0.147739104901338
     0                          0.149445554002917
     0.148874338981631  	0.147739104901338
     0.29439286270146   	0.14277593857706
     0.433395394129247  	0.134709217311473
     0.562757134668605  	0.123491976262066
     0.679409568299024  	0.109387158802298
     0.780817726586417  	0.0931254545836976
     0.865063366688985  	0.07503967481092
     0.930157491355708  	0.054755896574352
     0.973906528517172  	0.0325581623079647
     0.995657163025808  	0.0116946388673719

    STB Laurie Gautschi
    -0.995657163025808  	0.0116946388673719
    -0.973906528517172  	0.0325581623079647
    -0.930157491355708  	0.054755896574352
    -0.865063366688985  	0.07503967481092
    -0.780817726586417  	0.0931254545836976
    -0.679409568299024  	0.109387158802298
    -0.562757134668605  	0.123491976262066
    -0.433395394129247  	0.134709217311473
    -0.29439286270146   	0.14277593857706
    -0.148874338981631  	0.147739104901338
     1.72723371101889e-77	0.149445554002917
     0.148874338981631  	0.147739104901338
     0.29439286270146   	0.14277593857706
     0.433395394129247  	0.134709217311473
     0.562757134668605  	0.123491976262066
     0.679409568299024  	0.109387158802298
     0.780817726586417  	0.0931254545836976
     0.865063366688985  	0.07503967481092
     0.930157491355708  	0.054755896574352
     0.973906528517172  	0.0325581623079647
     0.995657163025808  	0.0116946388673719

    MS Piessens
    -0.995657163025808  	0.0116946388673719
    -0.973906528517172  	0.0325581623079647
    -0.930157491355708  	0.054755896574352
    -0.865063366688985  	0.07503967481092
    -0.780817726586417  	0.0931254545836976
    -0.679409568299024  	0.109387158802298
    -0.562757134668605  	0.123491976262066
    -0.433395394129247  	0.134709217311473
    -0.29439286270146   	0.14277593857706
    -0.148874338981631  	0.147739104901338
    -0                          0.149445554002917
     0.148874338981631  	0.147739104901338
     0.29439286270146   	0.14277593857706
     0.433395394129247  	0.134709217311473
     0.562757134668605  	0.123491976262066
     0.679409568299024  	0.109387158802298
     0.780817726586417  	0.0931254545836976
     0.865063366688985  	0.07503967481092
     0.930157491355708  	0.054755896574352
     0.973906528517172  	0.0325581623079647
     0.995657163025808  	0.0116946388673719


## Differences in Results between Approaches
    Here are the differences between each the approaches, beginning with highest precision:

## `RealType` => `mpreal(256)`

    Solution Differences: MS - STB Laurie Gautschi  

     7.772551699585  e-77   	 3.53543150224179e-77
     6.90893484407556e-77   	-1.03634022661133e-76
    -8.63616855509444e-77   	 1.17128036028468e-76
    -3.45446742203778e-77   	-4.31808427754722e-78
     4.31808427754722e-77   	-4.64194059836326e-77
     8.63616855509444e-77   	 6.47712641632083e-78
     0                           4.74989270530194e-77
     6.90893484407556e-77   	 2.37494635265097e-77
    -6.90893484407556e-77   	-2.37494635265097e-77
     1.72723371101889e-77   	 3.8862758497925 e-77
    -1.72723371101889e-77   	 7.12483905795292e-77
     2.07268045322267e-76   	-2.43971761681418e-76
    -1.38178696881511e-76   	-1.53291991852926e-76
    -1.20906359771322e-76   	 1.16588275493775e-76
     1.554510339917  e-76   	 1.51132949714153e-77
     1.89995708212078e-76   	 1.69484807893728e-76
    -1.03634022661133e-76   	-1.71643850032502e-76
    -1.554510339917  e-76   	-2.35335593126324e-76
     6.90893484407556e-77   	-1.75215445490568e-73
     3.45446742203778e-77   	 1.79763467755895e-73
     3.97263753534344e-76   	-4.31039268992784e-75


    Solution Differences: MS Laurie Gautschi - MS Piessens  

     4.21106058237027e-33   	 8.63217497845608e-18
     1.56729581752818e-47   	-1.89364940663373e-18
    -1.44074223728992e-38   	 3.04312813894024e-18
     2.86470404844007e-36   	 1.0300447788649 e-18
     7.55024669456578e-43   	 5.16953089748123e-18
     1.44049420621395e-45   	-6.0894263519759 e-18
    -2.77857411128062e-55   	 6.85518177013818e-18
     8.32044146455269e-56   	-7.46944184211614e-18
     7.83664427226274e-56   	 7.92565671854014e-18
     3.35159104555395e-59   	-8.20372213568466e-18
     0                           8.295894749095  e-18
    -3.35159104555395e-59   	-8.20372213568466e-18
    -7.83664427226274e-56   	 7.92565671854014e-18
    -8.32044146455269e-56   	-7.46944184211614e-18
     2.77857411128062e-55   	 6.85518177013818e-18
    -1.44049420621395e-45   	-6.0894263519759 e-18
    -7.55024669456578e-43   	 5.16953089748123e-18
    -2.86470404844007e-36   	 1.0300447788649 e-18
     1.44074223728992e-38   	 3.04312813894024e-18
    -1.56729581752818e-47   	-1.89364940663373e-18
    -4.21106058237027e-33   	 8.63217497845608e-18


    Solution Differences: STB Laurie Gautschi - MS Piessens 

     4.21106058237027e-33   	 8.63217497845608e-18
     1.56729581752818e-47   	-1.89364940663373e-18
    -1.44074223728992e-38   	 3.04312813894024e-18
     2.86470404844007e-36   	 1.0300447788649 e-18
     7.55024669456578e-43   	 5.16953089748123e-18
     1.44049420621395e-45   	-6.0894263519759 e-18
    -2.77857411128062e-55   	 6.85518177013818e-18
     8.32044146455269e-56   	-7.46944184211614e-18
     7.83664427226274e-56   	 7.92565671854014e-18
     3.35159104555395e-59   	-8.20372213568466e-18
     1.72723371101889e-77   	 8.295894749095  e-18
    -3.35159104555395e-59   	-8.20372213568466e-18
    -7.83664427226274e-56   	 7.92565671854014e-18
    -8.32044146455269e-56   	-7.46944184211614e-18
     2.77857411128062e-55   	 6.85518177013818e-18
    -1.44049420621395e-45   	-6.0894263519759 e-18
    -7.55024669456578e-43   	 5.16953089748123e-18
    -2.86470404844007e-36   	 1.0300447788649 e-18
     1.44074223728992e-38   	 3.04312813894024e-18
    -1.56729581752818e-47   	-1.89364940663373e-18
    -4.21106058237027e-33   	 8.63217497845608e-18


## `RealType` => `double`

    Solution Differences: MS - STB Laurie Gautschi  

     0.000000000000000  	 0.000000000000000
    -0.000000000000001  	 0.000000000000000
     0.000000000000000  	-0.000000000000000
     0.000000000000000  	 0.000000000000000
     0.000000000000000  	 0.000000000000000
    -0.000000000000001  	 0.000000000000002
     0.000000000000001  	-0.000000000000004
     0.000000000000001  	 0.000000000000003
     0.000000000000000  	-0.000000000000001
     0.000000000000001  	 0.000000000000000
     0.000000000000003  	-0.000000000000000
     0.000000000000001  	 0.000000000000003
    -0.000000000000000  	-0.000000000000000
    -0.000000000000001  	-0.000000000000002
    -0.000000000000002  	-0.000000000000002
    -0.000000000000001  	 0.000000000000002
    -0.000000000000001  	-0.000000000000003
    -0.000000000000003  	 0.000000000000000
    -0.000000000000003  	 0.000000000000002
    -0.000000000000003  	-0.000000000000006
     0.000000000000002  	 0.000000000000006

    Solution Differences: MS Laurie Gautschi - MS Piessens

     0.000000000000000  	-0.000000000000000
    -0.000000000000001  	 0.000000000000002
     0.000000000000000  	-0.000000000000001
     0.000000000000000  	 0.000000000000000
     0.000000000000000  	 0.000000000000000
    -0.000000000000001  	-0.000000000000001
     0.000000000000000  	 0.000000000000000
     0.000000000000000  	 0.000000000000001
     0.000000000000000  	-0.000000000000001
     0.000000000000000  	-0.000000000000001
     0.000000000000003  	-0.000000000000000
     0.000000000000000  	 0.000000000000003
     0.000000000000001  	 0.000000000000001
     0.000000000000000  	 0.000000000000000
     0.000000000000000  	-0.000000000000000
    -0.000000000000001  	 0.000000000000001
    -0.000000000000001  	-0.000000000000001
    -0.000000000000001  	-0.000000000000001
    -0.000000000000002  	 0.000000000000003
    -0.000000000000002  	-0.000000000000004
     0.000000000000002  	 0.000000000000003

    Solution Differences: STB Laurie Gautschi - MS Piessens

     0.000000000000000  	-0.000000000000001
     0.000000000000000  	 0.000000000000001
     0.000000000000000  	-0.000000000000000
     0.000000000000000  	 0.000000000000000
     0.000000000000000  	 0.000000000000000
     0.000000000000000  	-0.000000000000003
    -0.000000000000000  	 0.000000000000004
    -0.000000000000000  	-0.000000000000002
    -0.000000000000000  	 0.000000000000000
    -0.000000000000001  	-0.000000000000001
    -0.000000000000001  	 0.000000000000000
    -0.000000000000000  	-0.000000000000001
     0.000000000000001  	 0.000000000000001
     0.000000000000002  	 0.000000000000002
     0.000000000000002  	 0.000000000000001
    -0.000000000000000  	-0.000000000000001
     0.000000000000000  	 0.000000000000001
     0.000000000000002  	-0.000000000000001
     0.000000000000001  	 0.000000000000001
     0.000000000000001  	 0.000000000000002
    -0.000000000000000		-0.000000000000003


## Discussion

The results demonstrate near perfect agreement at highest precision when comparing the MS and STB Laurie approaches. The results do, however, illustrate differences at double precision between the two Laurie implementations compared with each other.

The results also demonstrate near perfect agreement between both the MS and STB Laurie implmentations as compared against the MS Piessens approach at highest precision.

The MS and STB Laurie approaches yeild varying differences of the same magnitude when compared against the Piessens approach at double precision.  These differences, interestingly, are greater when the two Laurie approaches are compared against each other.

Last, it is interesting to see that discrepancy between the MS Laurie and MS Piessens approach would be degraded if symmetry is used to remove the negative nodes, but it appears that it would benefit the STB Laurie approach.


## Next steps

The Piessens code requires additional refactoring to allow the machineEpsilon function to be templated properly and make use of the additional ISO round-off error values.

Sree, if you might be willing to tackle this, you are the only one of the group capable of succedding at this for the moment.

The next work likely exists in making the node/weight calculations output similar formatted values to work well with the integration routines so that the integrated values of each approach may be compared against known integral values.

